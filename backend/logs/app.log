2026-02-27 10:02:47,665 | INFO | app.execution | WS client disconnected for task 5dbaba03-328d-4176-904a-9eb9eff471aa
2026-02-27 10:02:47,849 | INFO | uvicorn.error | connection closed
2026-02-27 10:02:48,676 | INFO | app | [a1581511] GET /api/v1/tasks/5dbaba03-328d-4176-904a-9eb9eff471aa -> 200 (236.86ms)
2026-02-27 10:02:48,677 | INFO | uvicorn.access | 127.0.0.1:61850 - "GET /api/v1/tasks/5dbaba03-328d-4176-904a-9eb9eff471aa HTTP/1.1" 200
2026-02-27 10:02:48,697 | INFO | uvicorn.error | ('127.0.0.1', 61854) - "WebSocket /api/v1/execution/ws/5dbaba03-328d-4176-904a-9eb9eff471aa" [accepted]
2026-02-27 10:02:48,697 | INFO | app.execution | WS client connected for task 5dbaba03-328d-4176-904a-9eb9eff471aa (total: 1)
2026-02-27 10:02:48,700 | INFO | uvicorn.error | connection open
2026-02-27 10:20:48,536 | INFO | app.execution | WS client disconnected for task 5dbaba03-328d-4176-904a-9eb9eff471aa
2026-02-27 10:20:48,544 | INFO | uvicorn.error | connection closed
2026-02-27 10:20:48,604 | INFO | uvicorn.error | ('127.0.0.1', 52467) - "WebSocket /api/v1/execution/ws/5dbaba03-328d-4176-904a-9eb9eff471aa" [accepted]
2026-02-27 10:20:48,606 | INFO | app.execution | WS client connected for task 5dbaba03-328d-4176-904a-9eb9eff471aa (total: 1)
2026-02-27 10:20:48,616 | INFO | uvicorn.error | connection open
2026-02-27 10:20:56,893 | INFO | app.execution | WS client disconnected for task 5dbaba03-328d-4176-904a-9eb9eff471aa
2026-02-27 10:20:56,900 | INFO | uvicorn.error | connection closed
2026-02-27 10:20:56,947 | INFO | app | [8e33e12d] OPTIONS /api/v1/tasks/5dbaba03-328d-4176-904a-9eb9eff471aa -> 200 (3.15ms)
2026-02-27 10:20:56,948 | INFO | uvicorn.access | 127.0.0.1:52536 - "OPTIONS /api/v1/tasks/5dbaba03-328d-4176-904a-9eb9eff471aa HTTP/1.1" 200
2026-02-27 10:20:57,110 | INFO | app | [baea5489] GET /api/v1/tasks/5dbaba03-328d-4176-904a-9eb9eff471aa -> 200 (159.21ms)
2026-02-27 10:20:57,111 | INFO | uvicorn.access | 127.0.0.1:52538 - "GET /api/v1/tasks/5dbaba03-328d-4176-904a-9eb9eff471aa HTTP/1.1" 200
2026-02-27 10:20:57,141 | INFO | uvicorn.error | ('127.0.0.1', 52540) - "WebSocket /api/v1/execution/ws/5dbaba03-328d-4176-904a-9eb9eff471aa" [accepted]
2026-02-27 10:20:57,141 | INFO | app.execution | WS client connected for task 5dbaba03-328d-4176-904a-9eb9eff471aa (total: 1)
2026-02-27 10:20:57,142 | INFO | uvicorn.error | connection open
2026-02-27 10:32:45,560 | INFO | app.execution | WS client disconnected for task 5dbaba03-328d-4176-904a-9eb9eff471aa
2026-02-27 10:32:45,566 | INFO | uvicorn.error | connection closed
2026-02-27 10:32:45,652 | INFO | app | [2209342d] OPTIONS /api/v1/tasks?page=1&page_size=10 -> 200 (10.80ms)
2026-02-27 10:32:45,653 | INFO | uvicorn.access | 127.0.0.1:61700 - "OPTIONS /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:32:45,770 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=2 total=2
2026-02-27 10:32:45,782 | INFO | app | [8fc05130] GET /api/v1/tasks?page=1&page_size=10 -> 200 (125.42ms)
2026-02-27 10:32:45,782 | INFO | uvicorn.access | 127.0.0.1:61700 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:49:36,352 | INFO | uvicorn.error | Shutting down
2026-02-27 10:49:36,472 | INFO | uvicorn.error | Waiting for application shutdown.
2026-02-27 10:49:36,495 | INFO | uvicorn.error | Application shutdown complete.
2026-02-27 10:49:36,500 | INFO | uvicorn.error | Finished server process [37912]
2026-02-27 10:49:39,308 | INFO | uvicorn.error | Started server process [72554]
2026-02-27 10:49:39,308 | INFO | uvicorn.error | Waiting for application startup.
2026-02-27 10:49:39,309 | INFO | app | Starting API with env=development db=postgresql+asyncpg://postgres:postgres@localhost:5432/task_manager
2026-02-27 10:49:39,572 | INFO | uvicorn.error | Application startup complete.
2026-02-27 10:49:43,927 | INFO | uvicorn.error | Shutting down
2026-02-27 10:49:44,031 | INFO | uvicorn.error | Waiting for application shutdown.
2026-02-27 10:49:44,032 | INFO | uvicorn.error | Application shutdown complete.
2026-02-27 10:49:44,032 | INFO | uvicorn.error | Finished server process [72554]
2026-02-27 10:49:44,727 | INFO | uvicorn.error | Started server process [72778]
2026-02-27 10:49:44,728 | INFO | uvicorn.error | Waiting for application startup.
2026-02-27 10:49:44,728 | INFO | app | Starting API with env=development db=postgresql+asyncpg://postgres:postgres@localhost:5432/task_manager
2026-02-27 10:49:44,859 | INFO | uvicorn.error | Application startup complete.
2026-02-27 10:50:57,917 | INFO | app | [ab5667b5] OPTIONS /api/v1/tasks?page=1&page_size=10 -> 200 (0.72ms)
2026-02-27 10:50:57,917 | INFO | uvicorn.access | 127.0.0.1:52767 - "OPTIONS /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:50:58,019 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=2 total=2
2026-02-27 10:50:58,024 | INFO | app | [11cc53e7] GET /api/v1/tasks?page=1&page_size=10 -> 200 (104.81ms)
2026-02-27 10:50:58,024 | INFO | uvicorn.access | 127.0.0.1:52767 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:51:04,167 | INFO | uvicorn.error | Shutting down
2026-02-27 10:51:04,270 | INFO | uvicorn.error | Waiting for application shutdown.
2026-02-27 10:51:04,274 | INFO | uvicorn.error | Application shutdown complete.
2026-02-27 10:51:04,275 | INFO | uvicorn.error | Finished server process [72778]
2026-02-27 10:51:06,245 | INFO | uvicorn.error | Started server process [73608]
2026-02-27 10:51:06,245 | INFO | uvicorn.error | Waiting for application startup.
2026-02-27 10:51:06,246 | INFO | app | Starting API with env=development db=postgresql+asyncpg://postgres:postgres@localhost:5432/task_manager
2026-02-27 10:51:06,490 | INFO | uvicorn.error | Application startup complete.
2026-02-27 10:51:10,004 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=2 total=2
2026-02-27 10:51:10,009 | INFO | app | [b3961b81] GET /api/v1/tasks?page=1&page_size=10 -> 200 (99.83ms)
2026-02-27 10:51:10,009 | INFO | uvicorn.access | 127.0.0.1:52838 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:51:10,760 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=2 total=2
2026-02-27 10:51:10,762 | INFO | app | [a2d41e24] GET /api/v1/tasks?page=1&page_size=10 -> 200 (18.98ms)
2026-02-27 10:51:10,763 | INFO | uvicorn.access | 127.0.0.1:52838 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:51:20,454 | INFO | uvicorn.error | ('127.0.0.1', 52905) - "WebSocket /api/v1/execution/ws/ca388b49-e51a-4379-bb65-c3c45e9c44ad" [accepted]
2026-02-27 10:51:20,456 | INFO | app.execution | WS client connected for task ca388b49-e51a-4379-bb65-c3c45e9c44ad (total: 1)
2026-02-27 10:51:20,476 | INFO | uvicorn.error | connection open
2026-02-27 10:51:20,477 | INFO | app | [8b376c78] OPTIONS /api/v1/execution/task/ca388b49-e51a-4379-bb65-c3c45e9c44ad -> 200 (4.10ms)
2026-02-27 10:51:20,477 | INFO | uvicorn.access | 127.0.0.1:52907 - "OPTIONS /api/v1/execution/task/ca388b49-e51a-4379-bb65-c3c45e9c44ad HTTP/1.1" 200
2026-02-27 10:51:20,703 | INFO | app.execution | GetTaskInfoNode task_id bound before execute: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad matched_nodes=1
2026-02-27 10:51:20,703 | INFO | app.execution | Execute task requested: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad status=cancelled has_workflow=True node_count=28
2026-02-27 10:51:20,721 | INFO | app.execution | Task marked running on execute request: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad
2026-02-27 10:51:20,721 | INFO | app.comfyui | Connecting to ComfyUI WS: ws://34.59.208.230:8188/ws?clientId=d80d666b1ef745bd924bb12c81c7d5e8
2026-02-27 10:51:22,505 | ERROR | app.comfyui | ComfyUI WS listener error
Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/http.py", line 120, in read_response
    status_line = await read_line(stream)
                  ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/http.py", line 200, in read_line
    raise EOFError("line without CRLF")
EOFError: line without CRLF

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/client.py", line 134, in read_http_response
    status_code, reason, headers = await read_response(self.reader)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/http.py", line 122, in read_response
    raise EOFError("connection closed while reading HTTP status line") from exc
EOFError: connection closed while reading HTTP status line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/services/comfyui_service.py", line 167, in listen_comfyui_ws
    async with websockets.connect(ws_url) as ws:
               ~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/client.py", line 635, in __aenter__
    return await self
           ^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/client.py", line 656, in __await_impl__
    await protocol.handshake(
    ...<5 lines>...
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/client.py", line 316, in handshake
    status_code, response_headers = await self.read_http_response()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/client.py", line 136, in read_http_response
    raise InvalidMessage("did not receive a valid HTTP response") from exc
websockets.legacy.exceptions.InvalidMessage: did not receive a valid HTTP response
2026-02-27 10:51:22,526 | ERROR | app.execution | ComfyUI listener failed for task ca388b49-e51a-4379-bb65-c3c45e9c44ad
Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
        lambda protocol: protocol.bind_execute(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            self._state, args, '', limit, True, timeout))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.InvalidTextRepresentationError: invalid input value for enum task_status: "fail"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: invalid input value for enum task_status: "fail"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/api/v1/execution.py", line 840, in _run_comfyui_listener
    await _set_task_status(task_id=task_id, status_value=TaskStatus.fail, message=message)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/api/v1/execution.py", line 602, in _set_task_status
    await session.commit()
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py", line 1011, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper,
        ^^^^^^^^^^^^
    ...<3 lines>...
        update,
        ^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: invalid input value for enum task_status: "fail"
[SQL: UPDATE tasks SET status=$1::task_status, comfy_message=$2::VARCHAR, execution_state=$3::VARCHAR, updated_at=$4::TIMESTAMP WITH TIME ZONE WHERE tasks.id = $5::UUID]
[parameters: ('fail', 'Lost connection to ComfyUI before completion', '{"task_id": "ca388b49-e51a-4379-bb65-c3c45e9c44ad", "status": "fail", "prompt_id": "", "prompt_ids": [], "completed_prompt_ids": [], "current_node_id ... (309 characters truncated) ...  {"time": "10:51:22", "message": "Lost connection to ComfyUI before completion", "type": "error"}], "updated_at": "2026-02-27T02:51:22.510236+00:00"}', datetime.datetime(2026, 2, 27, 2, 51, 22, 518715, tzinfo=datetime.timezone.utc), UUID('ca388b49-e51a-4379-bb65-c3c45e9c44ad'))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2026-02-27 10:51:23,721 | WARNING | app.execution | ComfyUI listener did not connect within timeout, will still submit: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad client_id=d80d666b1ef745bd924bb12c81c7d5e8
2026-02-27 10:51:23,722 | INFO | app.comfyui | Submitting prompt to ComfyUI: api_url=http://34.59.208.230:8188/api/prompt client_id=d80d666b1ef745bd924bb12c81c7d5e8 node_count=28
2026-02-27 10:51:25,524 | INFO | httpx | HTTP Request: POST http://34.59.208.230:8188/api/prompt "HTTP/1.1 502 Bad Gateway"
2026-02-27 10:51:25,525 | ERROR | app.comfyui | ComfyUI /api/prompt returned 502: 
2026-02-27 10:51:25,527 | INFO | app.execution | ComfyUI submit result: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad prompt_id= error=ComfyUI returned HTTP 502: 
2026-02-27 10:51:25,537 | ERROR | app | [e8e6eaaf] POST /api/v1/execution/task/ca388b49-e51a-4379-bb65-c3c45e9c44ad -> 500 (5055.38ms)
Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
        lambda protocol: protocol.bind_execute(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            self._state, args, '', limit, True, timeout))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.InvalidTextRepresentationError: invalid input value for enum task_status: "fail"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: invalid input value for enum task_status: "fail"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/main.py", line 38, in request_logging_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/api/v1/execution.py", line 336, in execute_task
    await _set_task_status(task_id=str(task_id), status_value=TaskStatus.fail, message=result.error)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/api/v1/execution.py", line 602, in _set_task_status
    await session.commit()
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py", line 1011, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper,
        ^^^^^^^^^^^^
    ...<3 lines>...
        update,
        ^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: invalid input value for enum task_status: "fail"
[SQL: UPDATE tasks SET status=$1::task_status, comfy_message=$2::VARCHAR, updated_at=$3::TIMESTAMP WITH TIME ZONE WHERE tasks.id = $4::UUID]
[parameters: ('fail', 'ComfyUI returned HTTP 502: ', datetime.datetime(2026, 2, 27, 2, 51, 25, 534515, tzinfo=datetime.timezone.utc), UUID('ca388b49-e51a-4379-bb65-c3c45e9c44ad'))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2026-02-27 10:51:25,544 | INFO | uvicorn.access | 127.0.0.1:52907 - "POST /api/v1/execution/task/ca388b49-e51a-4379-bb65-c3c45e9c44ad HTTP/1.1" 500
2026-02-27 10:51:25,544 | ERROR | uvicorn.error | Exception in ASGI application
Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
        lambda protocol: protocol.bind_execute(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            self._state, args, '', limit, True, timeout))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.InvalidTextRepresentationError: invalid input value for enum task_status: "fail"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: invalid input value for enum task_status: "fail"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/.local/share/uv/python/cpython-3.13.3-macos-aarch64-none/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/main.py", line 38, in request_logging_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/api/v1/execution.py", line 336, in execute_task
    await _set_task_status(task_id=str(task_id), status_value=TaskStatus.fail, message=result.error)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/api/v1/execution.py", line 602, in _set_task_status
    await session.commit()
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py", line 1011, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper,
        ^^^^^^^^^^^^
    ...<3 lines>...
        update,
        ^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: invalid input value for enum task_status: "fail"
[SQL: UPDATE tasks SET status=$1::task_status, comfy_message=$2::VARCHAR, updated_at=$3::TIMESTAMP WITH TIME ZONE WHERE tasks.id = $4::UUID]
[parameters: ('fail', 'ComfyUI returned HTTP 502: ', datetime.datetime(2026, 2, 27, 2, 51, 25, 534515, tzinfo=datetime.timezone.utc), UUID('ca388b49-e51a-4379-bb65-c3c45e9c44ad'))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2026-02-27 10:51:25,565 | INFO | app.execution | WS client disconnected for task ca388b49-e51a-4379-bb65-c3c45e9c44ad
2026-02-27 10:51:25,567 | INFO | uvicorn.error | connection closed
2026-02-27 10:51:43,111 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=2 total=2
2026-02-27 10:51:43,113 | INFO | app | [14bc5d6c] GET /api/v1/tasks?page=1&page_size=10 -> 200 (40.64ms)
2026-02-27 10:51:43,114 | INFO | uvicorn.access | 127.0.0.1:53052 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:51:45,016 | INFO | uvicorn.error | ('127.0.0.1', 53066) - "WebSocket /api/v1/execution/ws/ca388b49-e51a-4379-bb65-c3c45e9c44ad" [accepted]
2026-02-27 10:51:45,017 | INFO | app.execution | WS client connected for task ca388b49-e51a-4379-bb65-c3c45e9c44ad (total: 1)
2026-02-27 10:51:45,021 | INFO | uvicorn.error | connection open
2026-02-27 10:51:52,172 | INFO | app | [8eafa8b1] OPTIONS /api/v1/execution/task/ca388b49-e51a-4379-bb65-c3c45e9c44ad/cancel -> 200 (0.56ms)
2026-02-27 10:51:52,172 | INFO | uvicorn.access | 127.0.0.1:53106 - "OPTIONS /api/v1/execution/task/ca388b49-e51a-4379-bb65-c3c45e9c44ad/cancel HTTP/1.1" 200
2026-02-27 10:51:54,450 | INFO | httpx | HTTP Request: POST http://34.59.208.230:8188/interrupt "HTTP/1.1 502 Bad Gateway"
2026-02-27 10:51:54,454 | ERROR | app.comfyui | ComfyUI /interrupt returned 502: 
2026-02-27 10:51:54,475 | INFO | app | [ec645127] POST /api/v1/execution/task/ca388b49-e51a-4379-bb65-c3c45e9c44ad/cancel -> 200 (2294.10ms)
2026-02-27 10:51:54,475 | INFO | uvicorn.access | 127.0.0.1:53108 - "POST /api/v1/execution/task/ca388b49-e51a-4379-bb65-c3c45e9c44ad/cancel HTTP/1.1" 200
2026-02-27 10:51:54,504 | INFO | app.execution | WS client disconnected for task ca388b49-e51a-4379-bb65-c3c45e9c44ad
2026-02-27 10:51:54,504 | INFO | uvicorn.error | connection closed
2026-02-27 10:51:54,524 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=2 total=2
2026-02-27 10:51:54,530 | INFO | app | [71ae3d77] GET /api/v1/tasks?page=1&page_size=10 -> 200 (34.73ms)
2026-02-27 10:51:54,531 | INFO | uvicorn.access | 127.0.0.1:53108 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:52:10,769 | INFO | app | [f48096c7] OPTIONS /api/v1/task-templates?page=1&page_size=100 -> 200 (7.34ms)
2026-02-27 10:52:10,774 | INFO | uvicorn.access | 127.0.0.1:53220 - "OPTIONS /api/v1/task-templates?page=1&page_size=100 HTTP/1.1" 200
2026-02-27 10:52:10,870 | INFO | app | [dd6291a3] GET /api/v1/task-templates?page=1&page_size=100 -> 200 (94.18ms)
2026-02-27 10:52:10,870 | INFO | uvicorn.access | 127.0.0.1:53220 - "GET /api/v1/task-templates?page=1&page_size=100 HTTP/1.1" 200
2026-02-27 10:52:15,227 | INFO | app | [593797d6] OPTIONS /api/v1/uploads/workflow -> 200 (0.55ms)
2026-02-27 10:52:15,228 | INFO | uvicorn.access | 127.0.0.1:53250 - "OPTIONS /api/v1/uploads/workflow HTTP/1.1" 200
2026-02-27 10:52:15,238 | INFO | app | [ac34f0f7] POST /api/v1/uploads/workflow -> 200 (8.40ms)
2026-02-27 10:52:15,239 | INFO | uvicorn.access | 127.0.0.1:53250 - "POST /api/v1/uploads/workflow HTTP/1.1" 200
2026-02-27 10:52:23,165 | INFO | app | [3ca4e4e6] OPTIONS /api/v1/tasks -> 200 (1.78ms)
2026-02-27 10:52:23,167 | INFO | uvicorn.access | 127.0.0.1:53287 - "OPTIONS /api/v1/tasks HTTP/1.1" 200
2026-02-27 10:52:23,299 | INFO | app | [2dff4209] POST /api/v1/tasks -> 200 (126.09ms)
2026-02-27 10:52:23,299 | INFO | uvicorn.access | 127.0.0.1:53287 - "POST /api/v1/tasks HTTP/1.1" 200
2026-02-27 10:52:23,345 | INFO | app | [d256975a] OPTIONS /api/v1/tasks/9aa1278e-3d46-4486-ab91-dc6636728cfe -> 200 (0.18ms)
2026-02-27 10:52:23,345 | INFO | uvicorn.access | 127.0.0.1:53287 - "OPTIONS /api/v1/tasks/9aa1278e-3d46-4486-ab91-dc6636728cfe HTTP/1.1" 200
2026-02-27 10:52:23,356 | INFO | app | [cf5a5854] GET /api/v1/tasks/9aa1278e-3d46-4486-ab91-dc6636728cfe -> 200 (9.72ms)
2026-02-27 10:52:23,356 | INFO | uvicorn.access | 127.0.0.1:53287 - "GET /api/v1/tasks/9aa1278e-3d46-4486-ab91-dc6636728cfe HTTP/1.1" 200
2026-02-27 10:52:29,502 | INFO | uvicorn.error | ('127.0.0.1', 53337) - "WebSocket /api/v1/execution/ws/9aa1278e-3d46-4486-ab91-dc6636728cfe" [accepted]
2026-02-27 10:52:29,503 | INFO | app.execution | WS client connected for task 9aa1278e-3d46-4486-ab91-dc6636728cfe (total: 1)
2026-02-27 10:52:29,506 | INFO | uvicorn.error | connection open
2026-02-27 10:52:29,507 | INFO | app | [d81a1309] OPTIONS /api/v1/execution/task/9aa1278e-3d46-4486-ab91-dc6636728cfe -> 200 (0.58ms)
2026-02-27 10:52:29,507 | INFO | uvicorn.access | 127.0.0.1:53339 - "OPTIONS /api/v1/execution/task/9aa1278e-3d46-4486-ab91-dc6636728cfe HTTP/1.1" 200
2026-02-27 10:52:29,541 | INFO | app.execution | Execute task requested: task_id=9aa1278e-3d46-4486-ab91-dc6636728cfe status=pending has_workflow=True node_count=3
2026-02-27 10:52:29,545 | INFO | app.execution | Task marked running on execute request: task_id=9aa1278e-3d46-4486-ab91-dc6636728cfe
2026-02-27 10:52:29,546 | INFO | app.comfyui | Connecting to ComfyUI WS: ws://34.59.208.230:8188/ws?clientId=9d86841039e44f73b1af23875098ff3c
2026-02-27 10:52:32,042 | ERROR | app.comfyui | ComfyUI WS listener error
Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/http.py", line 120, in read_response
    status_line = await read_line(stream)
                  ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/http.py", line 200, in read_line
    raise EOFError("line without CRLF")
EOFError: line without CRLF

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/client.py", line 134, in read_http_response
    status_code, reason, headers = await read_response(self.reader)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/http.py", line 122, in read_response
    raise EOFError("connection closed while reading HTTP status line") from exc
EOFError: connection closed while reading HTTP status line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/services/comfyui_service.py", line 167, in listen_comfyui_ws
    async with websockets.connect(ws_url) as ws:
               ~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/client.py", line 635, in __aenter__
    return await self
           ^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/client.py", line 656, in __await_impl__
    await protocol.handshake(
    ...<5 lines>...
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/client.py", line 316, in handshake
    status_code, response_headers = await self.read_http_response()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/client.py", line 136, in read_http_response
    raise InvalidMessage("did not receive a valid HTTP response") from exc
websockets.legacy.exceptions.InvalidMessage: did not receive a valid HTTP response
2026-02-27 10:52:32,073 | ERROR | app.execution | ComfyUI listener failed for task 9aa1278e-3d46-4486-ab91-dc6636728cfe
Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
        lambda protocol: protocol.bind_execute(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            self._state, args, '', limit, True, timeout))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.InvalidTextRepresentationError: invalid input value for enum task_status: "fail"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: invalid input value for enum task_status: "fail"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/api/v1/execution.py", line 840, in _run_comfyui_listener
    await _set_task_status(task_id=task_id, status_value=TaskStatus.fail, message=message)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/api/v1/execution.py", line 602, in _set_task_status
    await session.commit()
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py", line 1011, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper,
        ^^^^^^^^^^^^
    ...<3 lines>...
        update,
        ^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: invalid input value for enum task_status: "fail"
[SQL: UPDATE tasks SET status=$1::task_status, comfy_message=$2::VARCHAR, execution_state=$3::VARCHAR, updated_at=$4::TIMESTAMP WITH TIME ZONE WHERE tasks.id = $5::UUID]
[parameters: ('fail', 'Lost connection to ComfyUI before completion', '{"task_id": "9aa1278e-3d46-4486-ab91-dc6636728cfe", "status": "fail", "prompt_id": "", "prompt_ids": [], "completed_prompt_ids": [], "current_node_id ... (309 characters truncated) ...  {"time": "10:52:32", "message": "Lost connection to ComfyUI before completion", "type": "error"}], "updated_at": "2026-02-27T02:52:32.047044+00:00"}', datetime.datetime(2026, 2, 27, 2, 52, 32, 70814, tzinfo=datetime.timezone.utc), UUID('9aa1278e-3d46-4486-ab91-dc6636728cfe'))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2026-02-27 10:52:32,547 | WARNING | app.execution | ComfyUI listener did not connect within timeout, will still submit: task_id=9aa1278e-3d46-4486-ab91-dc6636728cfe client_id=9d86841039e44f73b1af23875098ff3c
2026-02-27 10:52:32,547 | INFO | app.comfyui | Submitting prompt to ComfyUI: api_url=http://34.59.208.230:8188/api/prompt client_id=9d86841039e44f73b1af23875098ff3c node_count=3
2026-02-27 10:52:33,932 | INFO | app.execution | WS client disconnected for task 9aa1278e-3d46-4486-ab91-dc6636728cfe
2026-02-27 10:52:33,933 | INFO | uvicorn.error | connection closed
2026-02-27 10:52:34,057 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=3 total=3
2026-02-27 10:52:34,059 | INFO | app | [7f04b24a] GET /api/v1/tasks?page=1&page_size=10 -> 200 (61.07ms)
2026-02-27 10:52:34,059 | INFO | uvicorn.access | 127.0.0.1:53367 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:52:34,663 | INFO | httpx | HTTP Request: POST http://34.59.208.230:8188/api/prompt "HTTP/1.1 502 Bad Gateway"
2026-02-27 10:52:34,665 | ERROR | app.comfyui | ComfyUI /api/prompt returned 502: 
2026-02-27 10:52:34,668 | INFO | app.execution | ComfyUI submit result: task_id=9aa1278e-3d46-4486-ab91-dc6636728cfe prompt_id= error=ComfyUI returned HTTP 502: 
2026-02-27 10:52:34,678 | ERROR | app | [3a3630df] POST /api/v1/execution/task/9aa1278e-3d46-4486-ab91-dc6636728cfe -> 500 (5169.92ms)
Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
        lambda protocol: protocol.bind_execute(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            self._state, args, '', limit, True, timeout))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.InvalidTextRepresentationError: invalid input value for enum task_status: "fail"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: invalid input value for enum task_status: "fail"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/main.py", line 38, in request_logging_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/api/v1/execution.py", line 336, in execute_task
    await _set_task_status(task_id=str(task_id), status_value=TaskStatus.fail, message=result.error)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/api/v1/execution.py", line 602, in _set_task_status
    await session.commit()
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py", line 1011, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper,
        ^^^^^^^^^^^^
    ...<3 lines>...
        update,
        ^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: invalid input value for enum task_status: "fail"
[SQL: UPDATE tasks SET status=$1::task_status, comfy_message=$2::VARCHAR, updated_at=$3::TIMESTAMP WITH TIME ZONE WHERE tasks.id = $4::UUID]
[parameters: ('fail', 'ComfyUI returned HTTP 502: ', datetime.datetime(2026, 2, 27, 2, 52, 34, 673895, tzinfo=datetime.timezone.utc), UUID('9aa1278e-3d46-4486-ab91-dc6636728cfe'))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2026-02-27 10:52:34,685 | INFO | uvicorn.access | 127.0.0.1:53339 - "POST /api/v1/execution/task/9aa1278e-3d46-4486-ab91-dc6636728cfe HTTP/1.1" 500
2026-02-27 10:52:34,685 | ERROR | uvicorn.error | Exception in ASGI application
Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
        lambda protocol: protocol.bind_execute(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            self._state, args, '', limit, True, timeout))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.InvalidTextRepresentationError: invalid input value for enum task_status: "fail"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: invalid input value for enum task_status: "fail"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/.local/share/uv/python/cpython-3.13.3-macos-aarch64-none/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/main.py", line 38, in request_logging_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/api/v1/execution.py", line 336, in execute_task
    await _set_task_status(task_id=str(task_id), status_value=TaskStatus.fail, message=result.error)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/api/v1/execution.py", line 602, in _set_task_status
    await session.commit()
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py", line 1011, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper,
        ^^^^^^^^^^^^
    ...<3 lines>...
        update,
        ^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: invalid input value for enum task_status: "fail"
[SQL: UPDATE tasks SET status=$1::task_status, comfy_message=$2::VARCHAR, updated_at=$3::TIMESTAMP WITH TIME ZONE WHERE tasks.id = $4::UUID]
[parameters: ('fail', 'ComfyUI returned HTTP 502: ', datetime.datetime(2026, 2, 27, 2, 52, 34, 673895, tzinfo=datetime.timezone.utc), UUID('9aa1278e-3d46-4486-ab91-dc6636728cfe'))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2026-02-27 10:53:11,048 | INFO | uvicorn.error | ('127.0.0.1', 53597) - "WebSocket /api/v1/execution/ws/9aa1278e-3d46-4486-ab91-dc6636728cfe" [accepted]
2026-02-27 10:53:11,050 | INFO | app.execution | WS client connected for task 9aa1278e-3d46-4486-ab91-dc6636728cfe (total: 1)
2026-02-27 10:53:11,057 | INFO | uvicorn.error | connection open
2026-02-27 10:53:26,531 | INFO | uvicorn.error | Shutting down
2026-02-27 10:53:26,541 | INFO | app.execution | WS client disconnected for task 9aa1278e-3d46-4486-ab91-dc6636728cfe
2026-02-27 10:53:26,542 | INFO | uvicorn.error | connection closed
2026-02-27 10:53:26,637 | INFO | uvicorn.error | Waiting for application shutdown.
2026-02-27 10:53:26,645 | INFO | uvicorn.error | Application shutdown complete.
2026-02-27 10:53:26,646 | INFO | uvicorn.error | Finished server process [73608]
2026-02-27 10:53:27,367 | INFO | uvicorn.error | Started server process [74807]
2026-02-27 10:53:27,367 | INFO | uvicorn.error | Waiting for application startup.
2026-02-27 10:53:27,368 | INFO | app | Starting API with env=development db=postgresql+asyncpg://postgres:postgres@localhost:5432/task_manager
2026-02-27 10:53:27,498 | INFO | uvicorn.error | Application startup complete.
2026-02-27 10:53:31,625 | INFO | uvicorn.error | Shutting down
2026-02-27 10:53:31,734 | INFO | uvicorn.error | Waiting for application shutdown.
2026-02-27 10:53:31,736 | INFO | uvicorn.error | Application shutdown complete.
2026-02-27 10:53:31,736 | INFO | uvicorn.error | Finished server process [74807]
2026-02-27 10:53:56,160 | INFO | uvicorn.error | Started server process [75293]
2026-02-27 10:53:56,160 | INFO | uvicorn.error | Waiting for application startup.
2026-02-27 10:53:56,160 | INFO | app | Starting API with env=development db=postgresql+asyncpg://postgres:postgres@localhost:5432/task_manager
2026-02-27 10:53:56,319 | INFO | uvicorn.error | Application startup complete.
2026-02-27 10:54:00,425 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=3 total=3
2026-02-27 10:54:00,433 | INFO | app | [a83092a3] GET /api/v1/tasks?page=1&page_size=10 -> 200 (117.95ms)
2026-02-27 10:54:00,433 | INFO | uvicorn.access | 127.0.0.1:53954 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:54:03,860 | INFO | uvicorn.error | ('127.0.0.1', 53980) - "WebSocket /api/v1/execution/ws/9aa1278e-3d46-4486-ab91-dc6636728cfe" [accepted]
2026-02-27 10:54:03,862 | INFO | app.execution | WS client connected for task 9aa1278e-3d46-4486-ab91-dc6636728cfe (total: 1)
2026-02-27 10:54:03,867 | INFO | uvicorn.error | connection open
2026-02-27 10:54:06,717 | INFO | app | [85349611] DELETE /api/v1/tasks/9aa1278e-3d46-4486-ab91-dc6636728cfe -> 200 (35.52ms)
2026-02-27 10:54:06,717 | INFO | uvicorn.access | 127.0.0.1:53992 - "DELETE /api/v1/tasks/9aa1278e-3d46-4486-ab91-dc6636728cfe HTTP/1.1" 200
2026-02-27 10:54:06,735 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=2 total=2
2026-02-27 10:54:06,736 | INFO | app | [8cf33b49] GET /api/v1/tasks?page=1&page_size=10 -> 200 (11.01ms)
2026-02-27 10:54:06,736 | INFO | uvicorn.access | 127.0.0.1:53992 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:54:06,743 | INFO | app.execution | WS client disconnected for task 9aa1278e-3d46-4486-ab91-dc6636728cfe
2026-02-27 10:54:06,744 | INFO | uvicorn.error | connection closed
2026-02-27 10:54:08,679 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=2 total=2
2026-02-27 10:54:08,682 | INFO | app | [11481389] GET /api/v1/tasks?page=1&page_size=10 -> 200 (16.74ms)
2026-02-27 10:54:08,683 | INFO | uvicorn.access | 127.0.0.1:54004 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:54:09,567 | INFO | app | [c45e9dcb] GET /api/v1/task-templates?page=1&page_size=100 -> 200 (27.13ms)
2026-02-27 10:54:09,567 | INFO | uvicorn.access | 127.0.0.1:54004 - "GET /api/v1/task-templates?page=1&page_size=100 HTTP/1.1" 200
2026-02-27 10:54:14,176 | INFO | app | [3590cef8] POST /api/v1/uploads/workflow -> 200 (3.50ms)
2026-02-27 10:54:14,177 | INFO | uvicorn.access | 127.0.0.1:54040 - "POST /api/v1/uploads/workflow HTTP/1.1" 200
2026-02-27 10:54:26,340 | INFO | app | [02fe2ad2] POST /api/v1/tasks -> 200 (67.40ms)
2026-02-27 10:54:26,340 | INFO | uvicorn.access | 127.0.0.1:54100 - "POST /api/v1/tasks HTTP/1.1" 200
2026-02-27 10:54:26,373 | INFO | app | [e18c7b4c] OPTIONS /api/v1/tasks/b804a7eb-1a53-41d7-8390-cf6ca341220d -> 200 (0.75ms)
2026-02-27 10:54:26,374 | INFO | uvicorn.access | 127.0.0.1:54100 - "OPTIONS /api/v1/tasks/b804a7eb-1a53-41d7-8390-cf6ca341220d HTTP/1.1" 200
2026-02-27 10:54:26,407 | INFO | app | [6b9db8c4] GET /api/v1/tasks/b804a7eb-1a53-41d7-8390-cf6ca341220d -> 200 (20.24ms)
2026-02-27 10:54:26,407 | INFO | uvicorn.access | 127.0.0.1:54100 - "GET /api/v1/tasks/b804a7eb-1a53-41d7-8390-cf6ca341220d HTTP/1.1" 200
2026-02-27 10:54:29,835 | INFO | uvicorn.error | ('127.0.0.1', 54138) - "WebSocket /api/v1/execution/ws/b804a7eb-1a53-41d7-8390-cf6ca341220d" [accepted]
2026-02-27 10:54:29,835 | INFO | app.execution | WS client connected for task b804a7eb-1a53-41d7-8390-cf6ca341220d (total: 1)
2026-02-27 10:54:29,836 | INFO | uvicorn.error | connection open
2026-02-27 10:54:29,837 | INFO | app | [19f4e573] OPTIONS /api/v1/execution/task/b804a7eb-1a53-41d7-8390-cf6ca341220d -> 200 (0.19ms)
2026-02-27 10:54:29,837 | INFO | uvicorn.access | 127.0.0.1:54140 - "OPTIONS /api/v1/execution/task/b804a7eb-1a53-41d7-8390-cf6ca341220d HTTP/1.1" 200
2026-02-27 10:54:29,938 | INFO | app.execution | Execute task requested: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d status=pending has_workflow=True node_count=3
2026-02-27 10:54:29,942 | INFO | app.execution | Task marked running on execute request: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d
2026-02-27 10:54:29,942 | INFO | app.comfyui | Connecting to ComfyUI WS: ws://34.59.208.230:8188/ws?clientId=1606f44f4d004e87860e83ba07a33f57
2026-02-27 10:54:31,752 | ERROR | app.comfyui | ComfyUI WS listener error
Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/http.py", line 120, in read_response
    status_line = await read_line(stream)
                  ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/http.py", line 200, in read_line
    raise EOFError("line without CRLF")
EOFError: line without CRLF

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/client.py", line 134, in read_http_response
    status_code, reason, headers = await read_response(self.reader)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/http.py", line 122, in read_response
    raise EOFError("connection closed while reading HTTP status line") from exc
EOFError: connection closed while reading HTTP status line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/app/services/comfyui_service.py", line 167, in listen_comfyui_ws
    async with websockets.connect(ws_url) as ws:
               ~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/client.py", line 635, in __aenter__
    return await self
           ^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/client.py", line 656, in __await_impl__
    await protocol.handshake(
    ...<5 lines>...
    )
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/client.py", line 316, in handshake
    status_code, response_headers = await self.read_http_response()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/guyin/Desktop/Echooo/repo/confyUI-flow-back/backend/.venv/lib/python3.13/site-packages/websockets/legacy/client.py", line 136, in read_http_response
    raise InvalidMessage("did not receive a valid HTTP response") from exc
websockets.legacy.exceptions.InvalidMessage: did not receive a valid HTTP response
2026-02-27 10:54:32,943 | WARNING | app.execution | ComfyUI listener did not connect within timeout, will still submit: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d client_id=1606f44f4d004e87860e83ba07a33f57
2026-02-27 10:54:32,945 | INFO | app.comfyui | Submitting prompt to ComfyUI: api_url=http://34.59.208.230:8188/api/prompt client_id=1606f44f4d004e87860e83ba07a33f57 node_count=3
2026-02-27 10:54:35,089 | INFO | httpx | HTTP Request: POST http://34.59.208.230:8188/api/prompt "HTTP/1.1 502 Bad Gateway"
2026-02-27 10:54:35,092 | ERROR | app.comfyui | ComfyUI /api/prompt returned 502: 
2026-02-27 10:54:35,094 | INFO | app.execution | ComfyUI submit result: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d prompt_id= error=ComfyUI returned HTTP 502: 
2026-02-27 10:54:35,131 | INFO | app | [bbe5abaa] POST /api/v1/execution/task/b804a7eb-1a53-41d7-8390-cf6ca341220d -> 502 (5293.47ms)
2026-02-27 10:54:35,131 | INFO | uvicorn.access | 127.0.0.1:54140 - "POST /api/v1/execution/task/b804a7eb-1a53-41d7-8390-cf6ca341220d HTTP/1.1" 502
2026-02-27 10:54:35,185 | INFO | app.execution | WS client disconnected for task b804a7eb-1a53-41d7-8390-cf6ca341220d
2026-02-27 10:54:35,185 | INFO | uvicorn.error | connection closed
2026-02-27 10:57:16,312 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=3 total=3
2026-02-27 10:57:16,320 | INFO | app | [2b847c67] GET /api/v1/tasks?page=1&page_size=10 -> 200 (90.21ms)
2026-02-27 10:57:16,320 | INFO | uvicorn.access | 127.0.0.1:55172 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:57:27,759 | INFO | uvicorn.error | ('127.0.0.1', 55228) - "WebSocket /api/v1/execution/ws/b804a7eb-1a53-41d7-8390-cf6ca341220d" [accepted]
2026-02-27 10:57:27,759 | INFO | app.execution | WS client connected for task b804a7eb-1a53-41d7-8390-cf6ca341220d (total: 1)
2026-02-27 10:57:27,761 | INFO | uvicorn.error | connection open
2026-02-27 10:57:27,790 | INFO | app.execution | Execute task requested: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d status=fail has_workflow=True node_count=3
2026-02-27 10:57:27,805 | INFO | app.execution | Task marked running on execute request: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d
2026-02-27 10:57:27,806 | INFO | app.comfyui | Connecting to ComfyUI WS: ws://34.59.208.230:8188/ws?clientId=426a0c8eddf74eec8198e5669cff0e49
2026-02-27 10:57:29,976 | INFO | app.comfyui | Connected to ComfyUI WS: client_id=426a0c8eddf74eec8198e5669cff0e49
2026-02-27 10:57:29,979 | INFO | app.execution | ComfyUI listener connected before submit: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d client_id=426a0c8eddf74eec8198e5669cff0e49
2026-02-27 10:57:29,979 | INFO | app.comfyui | Submitting prompt to ComfyUI: api_url=http://34.59.208.230:8188/api/prompt client_id=426a0c8eddf74eec8198e5669cff0e49 node_count=3
2026-02-27 10:57:30,034 | INFO | app.execution | Execution event relayed: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d type=status prompt_id=None node_id=None
2026-02-27 10:57:31,910 | INFO | httpx | HTTP Request: POST http://34.59.208.230:8188/api/prompt "HTTP/1.1 200 OK"
2026-02-27 10:57:31,915 | INFO | app.comfyui | ComfyUI /api/prompt accepted: prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e has_node_errors=False response_keys=['node_errors', 'number', 'prompt_id']
2026-02-27 10:57:31,917 | INFO | app.execution | ComfyUI submit result: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e error=
2026-02-27 10:57:31,926 | INFO | app.execution | Execution event relayed: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d type=status prompt_id=None node_id=None
2026-02-27 10:57:31,926 | INFO | app.execution | Execution event relayed: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d type=status prompt_id=None node_id=None
2026-02-27 10:57:31,927 | INFO | app.comfyui | ComfyUI event: type=execution_start prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e node_id=None
2026-02-27 10:57:31,927 | INFO | app.execution | Execution event relayed: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d type=execution_start prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e node_id=None
2026-02-27 10:57:31,930 | INFO | app.comfyui | ComfyUI event: type=execution_cached prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e node_id=None
2026-02-27 10:57:31,930 | INFO | app.execution | Execution event relayed: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d type=execution_cached prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e node_id=None
2026-02-27 10:57:31,930 | INFO | app.comfyui | ComfyUI event: type=executing prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e node_id=2
2026-02-27 10:57:31,930 | INFO | app.execution | Execution event relayed: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d type=executing prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e node_id=2
2026-02-27 10:57:31,931 | INFO | app.execution | Prompt id attached to listener: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e
2026-02-27 10:57:31,931 | INFO | app.execution | Execution start broadcasted: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e
2026-02-27 10:57:31,931 | INFO | app | [acdbd23f] POST /api/v1/execution/task/b804a7eb-1a53-41d7-8390-cf6ca341220d -> 200 (4170.31ms)
2026-02-27 10:57:31,931 | INFO | uvicorn.access | 127.0.0.1:55231 - "POST /api/v1/execution/task/b804a7eb-1a53-41d7-8390-cf6ca341220d HTTP/1.1" 200
2026-02-27 10:57:31,952 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=3 total=3
2026-02-27 10:57:31,954 | INFO | app | [2da2799e] GET /api/v1/tasks?page=1&page_size=10 -> 200 (15.06ms)
2026-02-27 10:57:31,954 | INFO | uvicorn.access | 127.0.0.1:55231 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:57:32,071 | INFO | app.comfyui | ComfyUI event: type=executing prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e node_id=1
2026-02-27 10:57:32,071 | INFO | app.execution | Execution event relayed: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d type=executing prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e node_id=1
2026-02-27 10:57:33,647 | INFO | app.comfyui | ComfyUI event: type=executing prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e node_id=3
2026-02-27 10:57:33,647 | INFO | app.execution | Execution event relayed: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d type=executing prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e node_id=3
2026-02-27 10:57:33,797 | INFO | app.comfyui | ComfyUI event: type=executed prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e node_id=3
2026-02-27 10:57:33,798 | INFO | app.execution | Execution event relayed: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d type=executed prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e node_id=3
2026-02-27 10:57:34,019 | INFO | app.execution | Execution event relayed: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d type=status prompt_id=None node_id=None
2026-02-27 10:57:34,019 | INFO | app.comfyui | ComfyUI event: type=executing prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e node_id=None
2026-02-27 10:57:34,019 | INFO | app.execution | Execution event relayed: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d type=executing prompt_id=28855300-9c1d-4ec0-949a-6da0598f0c1e node_id=None
2026-02-27 10:57:34,019 | INFO | app.execution | All prompts completed for task b804a7eb-1a53-41d7-8390-cf6ca341220d
2026-02-27 10:57:34,019 | INFO | app.execution | Finalizing task: task_id=b804a7eb-1a53-41d7-8390-cf6ca341220d final_status=success completed_prompt_ids=['28855300-9c1d-4ec0-949a-6da0598f0c1e']
2026-02-27 10:57:40,891 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=3 total=3
2026-02-27 10:57:40,894 | INFO | app | [f0c4f337] GET /api/v1/tasks?page=1&page_size=10 -> 200 (28.66ms)
2026-02-27 10:57:40,894 | INFO | uvicorn.access | 127.0.0.1:55318 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:57:40,901 | INFO | app.execution | WS client disconnected for task b804a7eb-1a53-41d7-8390-cf6ca341220d
2026-02-27 10:57:40,902 | INFO | uvicorn.error | connection closed
2026-02-27 10:57:45,513 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=3 total=3
2026-02-27 10:57:45,515 | INFO | app | [34552f7b] GET /api/v1/tasks?page=1&page_size=10 -> 200 (18.53ms)
2026-02-27 10:57:45,515 | INFO | uvicorn.access | 127.0.0.1:55337 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:57:58,482 | INFO | uvicorn.error | ('127.0.0.1', 55425) - "WebSocket /api/v1/execution/ws/ca388b49-e51a-4379-bb65-c3c45e9c44ad" [accepted]
2026-02-27 10:57:58,483 | INFO | app.execution | WS client connected for task ca388b49-e51a-4379-bb65-c3c45e9c44ad (total: 1)
2026-02-27 10:57:58,490 | INFO | uvicorn.error | connection open
2026-02-27 10:57:58,526 | INFO | app.execution | Execute task requested: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad status=cancelled has_workflow=True node_count=28
2026-02-27 10:57:58,539 | INFO | app.execution | Task marked running on execute request: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad
2026-02-27 10:57:58,539 | INFO | app.comfyui | Connecting to ComfyUI WS: ws://34.59.208.230:8188/ws?clientId=9c5102bfed8c4fdd87a69fb1062fd08a
2026-02-27 10:58:00,906 | INFO | app.comfyui | Connected to ComfyUI WS: client_id=9c5102bfed8c4fdd87a69fb1062fd08a
2026-02-27 10:58:00,907 | INFO | app.execution | ComfyUI listener connected before submit: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad client_id=9c5102bfed8c4fdd87a69fb1062fd08a
2026-02-27 10:58:00,907 | INFO | app.comfyui | Submitting prompt to ComfyUI: api_url=http://34.59.208.230:8188/api/prompt client_id=9c5102bfed8c4fdd87a69fb1062fd08a node_count=28
2026-02-27 10:58:00,958 | INFO | app.execution | Execution event relayed: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad type=status prompt_id=None node_id=None
2026-02-27 10:58:03,774 | INFO | httpx | HTTP Request: POST http://34.59.208.230:8188/api/prompt "HTTP/1.1 200 OK"
2026-02-27 10:58:03,780 | INFO | app.execution | Execution event relayed: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad type=status prompt_id=None node_id=None
2026-02-27 10:58:03,780 | INFO | app.execution | Execution event relayed: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad type=status prompt_id=None node_id=None
2026-02-27 10:58:03,781 | INFO | app.comfyui | ComfyUI event: type=execution_start prompt_id=7b69f27a-3112-4e8c-9ac8-9d83847953e4 node_id=None
2026-02-27 10:58:03,781 | INFO | app.execution | Execution event relayed: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad type=execution_start prompt_id=7b69f27a-3112-4e8c-9ac8-9d83847953e4 node_id=None
2026-02-27 10:58:03,784 | INFO | app.comfyui | ComfyUI event: type=execution_cached prompt_id=7b69f27a-3112-4e8c-9ac8-9d83847953e4 node_id=None
2026-02-27 10:58:03,787 | INFO | app.execution | Execution event relayed: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad type=execution_cached prompt_id=7b69f27a-3112-4e8c-9ac8-9d83847953e4 node_id=None
2026-02-27 10:58:03,798 | INFO | app.comfyui | ComfyUI event: type=executing prompt_id=7b69f27a-3112-4e8c-9ac8-9d83847953e4 node_id=18
2026-02-27 10:58:03,798 | INFO | app.execution | Execution event relayed: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad type=executing prompt_id=7b69f27a-3112-4e8c-9ac8-9d83847953e4 node_id=18
2026-02-27 10:58:03,801 | INFO | app.comfyui | ComfyUI /api/prompt accepted: prompt_id=7b69f27a-3112-4e8c-9ac8-9d83847953e4 has_node_errors=False response_keys=['node_errors', 'number', 'prompt_id']
2026-02-27 10:58:03,804 | INFO | app.execution | ComfyUI submit result: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad prompt_id=7b69f27a-3112-4e8c-9ac8-9d83847953e4 error=
2026-02-27 10:58:03,829 | INFO | app.execution | Prompt id attached to listener: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad prompt_id=7b69f27a-3112-4e8c-9ac8-9d83847953e4
2026-02-27 10:58:03,829 | INFO | app.execution | Execution start broadcasted: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad prompt_id=7b69f27a-3112-4e8c-9ac8-9d83847953e4
2026-02-27 10:58:03,838 | INFO | app | [8aece683] POST /api/v1/execution/task/ca388b49-e51a-4379-bb65-c3c45e9c44ad -> 200 (5351.45ms)
2026-02-27 10:58:03,838 | INFO | uvicorn.access | 127.0.0.1:55427 - "POST /api/v1/execution/task/ca388b49-e51a-4379-bb65-c3c45e9c44ad HTTP/1.1" 200
2026-02-27 10:58:03,879 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=3 total=3
2026-02-27 10:58:03,892 | INFO | app | [2d935f98] GET /api/v1/tasks?page=1&page_size=10 -> 200 (38.18ms)
2026-02-27 10:58:03,893 | INFO | uvicorn.access | 127.0.0.1:55427 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:58:10,097 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=3 total=3
2026-02-27 10:58:10,104 | INFO | app | [13ed7f14] GET /api/v1/tasks?page=1&page_size=10 -> 200 (37.10ms)
2026-02-27 10:58:10,104 | INFO | uvicorn.access | 127.0.0.1:55489 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:58:10,899 | INFO | app.comfyui | ComfyUI event: type=executing prompt_id=7b69f27a-3112-4e8c-9ac8-9d83847953e4 node_id=39
2026-02-27 10:58:10,899 | INFO | app.execution | Execution event relayed: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad type=executing prompt_id=7b69f27a-3112-4e8c-9ac8-9d83847953e4 node_id=39
2026-02-27 10:58:10,902 | INFO | app.comfyui | ComfyUI event: type=executing prompt_id=7b69f27a-3112-4e8c-9ac8-9d83847953e4 node_id=53
2026-02-27 10:58:10,903 | INFO | app.execution | Execution event relayed: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad type=executing prompt_id=7b69f27a-3112-4e8c-9ac8-9d83847953e4 node_id=53
2026-02-27 10:58:11,227 | INFO | app.comfyui | ComfyUI event: type=execution_error prompt_id=7b69f27a-3112-4e8c-9ac8-9d83847953e4 node_id=None
2026-02-27 10:58:11,228 | INFO | app.execution | Execution event relayed: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad type=execution_error prompt_id=7b69f27a-3112-4e8c-9ac8-9d83847953e4 node_id=None
2026-02-27 10:58:11,228 | INFO | app.execution | All prompts completed for task ca388b49-e51a-4379-bb65-c3c45e9c44ad
2026-02-27 10:58:11,228 | INFO | app.execution | Finalizing task: task_id=ca388b49-e51a-4379-bb65-c3c45e9c44ad final_status=fail completed_prompt_ids=['7b69f27a-3112-4e8c-9ac8-9d83847953e4']
2026-02-27 10:58:17,376 | INFO | app.execution | WS client disconnected for task ca388b49-e51a-4379-bb65-c3c45e9c44ad
2026-02-27 10:58:17,376 | INFO | uvicorn.error | connection closed
2026-02-27 10:58:18,546 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=3 total=3
2026-02-27 10:58:18,548 | INFO | app | [008ae73a] GET /api/v1/tasks?page=1&page_size=10 -> 200 (35.95ms)
2026-02-27 10:58:18,548 | INFO | uvicorn.access | 127.0.0.1:55529 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:58:29,576 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=3 total=3
2026-02-27 10:58:29,581 | INFO | app | [0399ce4b] GET /api/v1/tasks?page=1&page_size=10 -> 200 (39.73ms)
2026-02-27 10:58:29,582 | INFO | uvicorn.access | 127.0.0.1:55604 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:58:30,182 | INFO | app | [82b02fa6] GET /api/v1/tasks/b804a7eb-1a53-41d7-8390-cf6ca341220d -> 200 (25.71ms)
2026-02-27 10:58:30,183 | INFO | uvicorn.access | 127.0.0.1:55604 - "GET /api/v1/tasks/b804a7eb-1a53-41d7-8390-cf6ca341220d HTTP/1.1" 200
2026-02-27 10:58:35,796 | INFO | app | [391dbc11] GET /api/v1/tasks/b804a7eb-1a53-41d7-8390-cf6ca341220d -> 200 (47.02ms)
2026-02-27 10:58:35,796 | INFO | uvicorn.access | 127.0.0.1:55645 - "GET /api/v1/tasks/b804a7eb-1a53-41d7-8390-cf6ca341220d HTTP/1.1" 200
2026-02-27 10:58:40,453 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=3 total=3
2026-02-27 10:58:40,460 | INFO | app | [00f0f223] GET /api/v1/tasks?page=1&page_size=10 -> 200 (26.02ms)
2026-02-27 10:58:40,460 | INFO | uvicorn.access | 127.0.0.1:55671 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 10:59:55,937 | INFO | app | [ad2bf4dc] GET /api/v1/tasks/b804a7eb-1a53-41d7-8390-cf6ca341220d -> 200 (31.99ms)
2026-02-27 10:59:55,938 | INFO | uvicorn.access | 127.0.0.1:56081 - "GET /api/v1/tasks/b804a7eb-1a53-41d7-8390-cf6ca341220d HTTP/1.1" 200
2026-02-27 11:00:13,178 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=3 total=3
2026-02-27 11:00:13,180 | INFO | app | [269a37d3] GET /api/v1/tasks?page=1&page_size=10 -> 200 (35.91ms)
2026-02-27 11:00:13,180 | INFO | uvicorn.access | 127.0.0.1:56184 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 11:00:37,609 | INFO | app | [99ebb817] GET /api/v1/tasks/b804a7eb-1a53-41d7-8390-cf6ca341220d -> 200 (28.42ms)
2026-02-27 11:00:37,610 | INFO | uvicorn.access | 127.0.0.1:56313 - "GET /api/v1/tasks/b804a7eb-1a53-41d7-8390-cf6ca341220d HTTP/1.1" 200
2026-02-27 11:00:47,963 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=3 total=3
2026-02-27 11:00:47,965 | INFO | app | [6a21f66b] GET /api/v1/tasks?page=1&page_size=10 -> 200 (18.34ms)
2026-02-27 11:00:47,965 | INFO | uvicorn.access | 127.0.0.1:56366 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 11:00:58,556 | INFO | app | [f1e149be] GET /api/v1/tasks/b804a7eb-1a53-41d7-8390-cf6ca341220d -> 200 (23.35ms)
2026-02-27 11:00:58,556 | INFO | uvicorn.access | 127.0.0.1:56436 - "GET /api/v1/tasks/b804a7eb-1a53-41d7-8390-cf6ca341220d HTTP/1.1" 200
2026-02-27 11:01:07,177 | INFO | app | [7e10c72f] OPTIONS /api/v1/tasks?page=1&page_size=10 -> 200 (0.38ms)
2026-02-27 11:01:07,177 | INFO | uvicorn.access | 127.0.0.1:56480 - "OPTIONS /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 11:01:07,192 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=3 total=3
2026-02-27 11:01:07,194 | INFO | app | [719b8ed3] GET /api/v1/tasks?page=1&page_size=10 -> 200 (15.46ms)
2026-02-27 11:01:07,194 | INFO | uvicorn.access | 127.0.0.1:56480 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
2026-02-27 11:01:34,212 | INFO | app.tasks | list_tasks filters: task_id=None status=None page=1 page_size=10 -> items=3 total=3
2026-02-27 11:01:34,215 | INFO | app | [de738a49] GET /api/v1/tasks?page=1&page_size=10 -> 200 (70.85ms)
2026-02-27 11:01:34,216 | INFO | uvicorn.access | 127.0.0.1:56646 - "GET /api/v1/tasks?page=1&page_size=10 HTTP/1.1" 200
